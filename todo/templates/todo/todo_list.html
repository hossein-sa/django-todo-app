{% extends "base.html" %}
{% block content %}
<h2>To-Do List</h2>

<form method="post" action="{% url 'add_task' %}">
    {% csrf_token %}
    <input type="text" name="title" placeholder="Task Title" required>
    <input type="text" name="description" placeholder="Description">
    <button type="submit">Add</button>
</form>

<ul>
    {% for task in tasks %}
    <li>
        <span>{{ task.title }}</span>
        <button onclick="toggleTask({{ task.id }})">
            {% if task.status == "completed" %} ✅ {% else %} ⏳ {% endif %}
        </button>
        <a href="{% url 'delete_task' task.id %}">❌</a>
    </li>
    {% endfor %}
</ul>

<script>
function toggleTask(taskId) {
    fetch(`/toggle/${taskId}/`)
        .then(response => response.json())
        .then(data => location.reload());
}
</script>

{% endblock %}
